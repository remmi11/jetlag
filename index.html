<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>Click event in a popup</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
    <!-- <script src='https://api.mapbox.com/mapbox.js/plugins/arc.js/v0.1.0/arc.js'></script>
    <script src='https://npmcdn.com/@turf/turf@3.5.1/turf.min.js'></script> -->
    <script src="Leaflet.Geodesic.js"></script>


    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>

    <div id='map'></div>
    <!-- jQuery is required for this example. -->
    <script src='https://code.jquery.com/jquery-1.11.0.min.js'></script>
    <script>
        L.mapbox.accessToken = 'pk.eyJ1IjoibHVrZXRlY2giLCJhIjoiY2plOHVlOGJlMGZoazJxbGV2dzVpN29pZCJ9.gRAKacJQxFOUFsllGTHuew';
        var map = L.mapbox.map('map', 'mapbox.streets')
        var code = "1KKcO6Ui0dUsgmnkTqn8csgjbDFXkCAdatKAKa7QZkkU"

        var fg = L.featureGroup().addTo(map);
        var orleans = new L.LatLng(30.053206, -89.934873);
        var origin;
        Tabletop.init({
            key: code,
            callback: function (sheet, tabletop) {
                for (var i in sheet) {
                    var place = sheet[i];
                    marker = L.marker([place.lat, place.lon])
                        .addTo(fg)
                        .bindPopup(place.City)
                    origin = L.latLng(place.lat, place.lon);

                    console.log('var ' + place.Name + ' = [' + origin.lat + ', ' + origin.lng + '];');

                    var geodesic = L.geodesic([[origin, orleans]], {
                        weight: 3,
                        opacity: 1,
                        steps: 50
                    }).addTo(fg).addTo(map);

                }
                map.fitBounds(fg.getBounds());
            },
            simpleSheet: true
        })
    </script>

</body>

</html>